# Pythonæ–‡ä»¶æ“ä½œå®æˆ˜ï¼šç”¨é€’å½’å‡½æ•°ç”Ÿæˆå®Œæ•´æ–‡ä»¶æ¸…å•

## å‰è¨€

åœ¨æ—¥å¸¸çš„æ–‡ä»¶ç®¡ç†ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è·å–æŸä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨ã€‚ç‰¹åˆ«æ˜¯å½“é¡¹ç›®æ–‡ä»¶æŒ‰ç…§ä¸åŒç±»å‹åˆ†ç±»å­˜æ”¾åœ¨å¤šå±‚ç›®å½•ç»“æ„ä¸­æ—¶ï¼Œæ‰‹åŠ¨æŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶å¤¹æ˜¾ç„¶ä¸ç°å®ã€‚

ä»Šå¤©æˆ‘ä»¬å°±æ¥å­¦ä¹ å¦‚ä½•ç”¨Pythonè‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„æ–‡ä»¶æ¸…å•ï¼Œä¸ä»…èƒ½åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶ï¼Œè¿˜èƒ½æ·±å…¥åˆ°æ‰€æœ‰å­ç›®å½•ä¸­ï¼ŒæŠŠæ•´ä¸ªç›®å½•æ ‘çš„ç»“æ„å®Œæ•´åœ°å±•ç°å‡ºæ¥ã€‚

## éœ€æ±‚åˆ†æ

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œæ–‡ä»¶å·²ç»æŒ‰ç…§åç¼€ååˆ†ç±»åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ï¼š
- `files/jpg/` - å­˜æ”¾å›¾ç‰‡æ–‡ä»¶
- `files/pdf/` - å­˜æ”¾PDFæ–‡æ¡£  
- `files/python/` - å­˜æ”¾Pythonä»£ç 

æˆ‘ä»¬å¸Œæœ›ç”Ÿæˆä¸€ä¸ªæ¸…å•æ–‡ä»¶ï¼Œæ ¼å¼ç±»ä¼¼è¿™æ ·ï¼š
```
jpg/
    photo1.jpg
    photo2.jpg

pdf/
    document1.pdf
    document2.pdf

python/
    script1.py
    script2.py
```

## åˆæ­¥å°è¯•ï¼šos.listdir()çš„å±€é™æ€§

åˆšå¼€å§‹å­¦ä¹ æ–‡ä»¶æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³åˆ°ä½¿ç”¨`os.listdir()`å‡½æ•°ï¼š

```python
import os

# åˆ—å‡ºå½“å‰ç›®å½•å†…å®¹
file_list = os.listdir("files")
print("æ–‡ä»¶åˆ—è¡¨:", file_list)
```

è¿è¡Œè¿™æ®µä»£ç ï¼Œæˆ‘ä»¬ç¡®å®èƒ½è·å–åˆ°ç›®å½•ä¸‹çš„å†…å®¹ï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®é—®é¢˜ï¼š**`os.listdir()`åªèƒ½åˆ—å‡ºå½“å‰ç›®å½•çš„ç›´æ¥å­é¡¹ï¼Œä¸ä¼šæ·±å…¥åˆ°å­ç›®å½•ä¸­**ã€‚

å¦‚æœæˆ‘ä»¬çš„æ–‡ä»¶åˆ†å¸ƒåœ¨å¤šå±‚ç›®å½•ç»“æ„ä¸­ï¼Œè¿™ç§æ–¹æ³•å°±æ— æ³•æ»¡è¶³éœ€æ±‚äº†ã€‚

## æ€è·¯è½¬å˜ï¼šå¼•å…¥é€’å½’æ€ç»´

è¦è§£å†³æ·±å±‚éå†çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ¢ä¸ªæ€è·¯ã€‚æƒ³è±¡ä¸€ä¸‹äººå·¥æ•´ç†æ–‡ä»¶æ¸…å•çš„è¿‡ç¨‹ï¼š

1. æ‰“å¼€å½“å‰ç›®å½•ï¼Œçœ‹åˆ°æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
2. é‡åˆ°æ–‡ä»¶ï¼Œç›´æ¥è®°å½•ä¸‹æ¥
3. é‡åˆ°æ–‡ä»¶å¤¹ï¼Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ç»§ç»­é‡å¤ä¸Šè¿°è¿‡ç¨‹
4. ç›´åˆ°æ‰€æœ‰æ–‡ä»¶å¤¹éƒ½å¤„ç†å®Œæ¯•

è¿™ä¸ªè¿‡ç¨‹å¤©ç„¶å…·æœ‰**é€’å½’ç‰¹æ€§**ï¼šå¤„ç†æ–‡ä»¶å¤¹çš„æ–¹æ³•ï¼Œå’Œå¤„ç†æ•´ä¸ªç›®å½•çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼

## é€’å½’è§£å†³æ–¹æ¡ˆçš„æ¼”è¿›

### ç¬¬ä¸€ç‰ˆï¼šåŸºç¡€é€’å½’å®ç°

è®©æˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬ï¼ŒæŠŠç»“æœæ‰“å°åˆ°æ§åˆ¶å°ï¼š

```python
def list_files(dir_path):
    """é€’å½’éå†ç›®å½•å¹¶æ‰“å°æ–‡ä»¶æ¸…å•"""
    # ç¬¬ä¸€æ­¥ï¼šåˆ—ä¸¾å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹
    file_list = os.listdir(dir_path)
    
    # ç¬¬äºŒæ­¥ï¼šéå†å¹¶åˆ¤æ–­æ¯ä¸€é¡¹
    for file_name in file_list:
        # æ„å»ºå®Œæ•´è·¯å¾„
        full_path = os.path.join(dir_path, file_name)
        
        if os.path.isdir(full_path):
            # æ˜¯ç›®å½•ï¼šæ‰“å°ç›®å½•åï¼Œç„¶åé€’å½’å¤„ç†
            print(f"{file_name}/")
            list_files(full_path)  # é€’å½’è°ƒç”¨
            print()  # æ¯ç»„åæ·»åŠ ç©ºè¡Œ
        else:
            # æ˜¯æ–‡ä»¶ï¼šç›´æ¥æ‰“å°ï¼ˆæ·»åŠ ç¼©è¿›ç¾åŒ–ï¼‰
            print(f"\t{file_name}")

# è°ƒç”¨å‡½æ•°
list_files("files")
```

è¿™é‡Œæœ‰å‡ ä¸ªå…³é”®ç‚¹éœ€è¦æ³¨æ„ï¼š

1. **è·¯å¾„æ‹¼æ¥**ï¼šä½¿ç”¨`os.path.join()`è€Œä¸æ˜¯ç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œç¡®ä¿è·¯å¾„æ ¼å¼æ­£ç¡®
2. **é€’å½’è°ƒç”¨**ï¼šå½“å‘ç°æ˜¯ç›®å½•æ—¶ï¼Œç”¨åŒæ ·çš„å‡½æ•°å¤„ç†è¿™ä¸ªå­ç›®å½•
3. **æ ¼å¼ç¾åŒ–**ï¼šä¸ºæ–‡ä»¶åæ·»åŠ ç¼©è¿›ï¼Œè®©å±‚æ¬¡ç»“æ„æ›´æ¸…æ™°

### ç¬¬äºŒç‰ˆï¼šå†™å…¥æ–‡ä»¶çš„å®ç”¨ç‰ˆæœ¬

æ‰“å°åˆ°æ§åˆ¶å°åªæ˜¯éªŒè¯é€»è¾‘ï¼Œå®é™…ä½¿ç”¨ä¸­æˆ‘ä»¬éœ€è¦æŠŠç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚è®©æˆ‘ä»¬å¯¹å‡½æ•°è¿›è¡Œæ”¹è¿›ï¼š

```python
def list_files_to_txt(dir_path, output_file):
    """é€’å½’éå†ç›®å½•å¹¶å°†æ–‡ä»¶æ¸…å•å†™å…¥txtæ–‡ä»¶"""
    try:
        file_list = os.listdir(dir_path)
    except PermissionError:
        print(f"æ— æƒé™è®¿é—®ç›®å½•: {dir_path}")
        return
    
    for file_name in file_list:
        full_path = os.path.join(dir_path, file_name)
        
        if os.path.isdir(full_path):
            # å†™å…¥ç›®å½•å
            output_file.write(f"{file_name}/\n")
            # é€’å½’å¤„ç†å­ç›®å½•
            list_files_to_txt(full_path, output_file)
            output_file.write("\n")  # ç»„é—´åˆ†éš”
        else:
            # å†™å…¥æ–‡ä»¶å
            output_file.write(f"\t{file_name}\n")

def generate_file_list(target_dir="files", output_filename="list.txt"):
    """ç”Ÿæˆæ–‡ä»¶æ¸…å•çš„ä¸»å‡½æ•°"""
    print(f"=== å¼€å§‹ç”Ÿæˆ {target_dir} ç›®å½•çš„æ–‡ä»¶æ¸…å• ===")
    
    if not os.path.exists(target_dir):
        print(f"é”™è¯¯ï¼šç›®å½• '{target_dir}' ä¸å­˜åœ¨")
        return
    
    with open(output_filename, 'w', encoding='utf-8') as f:
        f.write(f"=== {target_dir} ç›®å½•æ–‡ä»¶æ¸…å• ===\n\n")
        list_files_to_txt(target_dir, f)
    
    print(f"æ–‡ä»¶æ¸…å•å·²ç”Ÿæˆåˆ°: {output_filename}")
```

è¿™ä¸ªç‰ˆæœ¬çš„æ”¹è¿›åŒ…æ‹¬ï¼š
- **å¼‚å¸¸å¤„ç†**ï¼šå¤„ç†æ— æƒé™è®¿é—®çš„ç›®å½•
- **æ–‡ä»¶æ“ä½œ**ï¼šä½¿ç”¨æ–‡ä»¶å¯¹è±¡è¿›è¡Œå†™å…¥æ“ä½œ
- **ç¼–ç æŒ‡å®š**ï¼šç¡®ä¿ä¸­æ–‡æ–‡ä»¶åæ­£ç¡®æ˜¾ç¤º
- **ç”¨æˆ·å‹å¥½**ï¼šæ·»åŠ è¿›åº¦æç¤ºå’Œé”™è¯¯ä¿¡æ¯

## è¿›é˜¶ç‰ˆæœ¬ï¼šå¸¦ç»Ÿè®¡åŠŸèƒ½çš„å¢å¼ºæ¸…å•

åŸºç¡€åŠŸèƒ½å®ç°åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­ä¼˜åŒ–ï¼Œæ·»åŠ æ›´å¤šå®ç”¨åŠŸèƒ½ï¼š

```python
def list_files_with_stats(dir_path, output_file, indent_level=0):
    """å¢å¼ºç‰ˆï¼šé€’å½’éå†å¹¶ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯"""
    indent = "\t" * indent_level
    file_count = 0
    dir_count = 0
    
    try:
        file_list = os.listdir(dir_path)
        file_list.sort()  # æ’åºï¼Œè®©è¾“å‡ºæ›´æ•´é½
    except PermissionError:
        output_file.write(f"{indent}[æ— æƒé™è®¿é—®]\n")
        return 0, 0
    
    for file_name in file_list:
        full_path = os.path.join(dir_path, file_name)
        
        if os.path.isdir(full_path):
            dir_count += 1
            output_file.write(f"{indent}ğŸ“ {file_name}/\n")
            # é€’å½’ç»Ÿè®¡å­ç›®å½•
            sub_files, sub_dirs = list_files_with_stats(full_path, output_file, indent_level + 1)
            file_count += sub_files
            dir_count += sub_dirs
        else:
            file_count += 1
            # è·å–æ–‡ä»¶å¤§å°
            try:
                file_size = os.path.getsize(full_path)
                size_str = format_file_size(file_size)
                output_file.write(f"{indent}ğŸ“„ {file_name} ({size_str})\n")
            except:
                output_file.write(f"{indent}ğŸ“„ {file_name}\n")
    
    return file_count, dir_count

def format_file_size(size_bytes):
    """æ ¼å¼åŒ–æ–‡ä»¶å¤§å°æ˜¾ç¤º"""
    if size_bytes < 1024:
        return f"{size_bytes} B"
    elif size_bytes < 1024 * 1024:
        return f"{size_bytes / 1024:.1f} KB"
    else:
        return f"{size_bytes / (1024 * 1024):.1f} MB"

def generate_enhanced_file_list(target_dir="files", output_filename="enhanced_list.txt"):
    """ç”Ÿæˆå¢å¼ºç‰ˆæ–‡ä»¶æ¸…å•"""
    if not os.path.exists(target_dir):
        print(f"é”™è¯¯ï¼šç›®å½• '{target_dir}' ä¸å­˜åœ¨")
        return
    
    with open(output_filename, 'w', encoding='utf-8') as f:
        f.write(f"=== {target_dir} ç›®å½•è¯¦ç»†æ¸…å• ===\n")
        f.write(f"ç”Ÿæˆæ—¶é—´: {__import__('datetime').datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
        
        total_files, total_dirs = list_files_with_stats(target_dir, f)
        
        f.write(f"\n=== ç»Ÿè®¡ä¿¡æ¯ ===\n")
        f.write(f"æ€»æ–‡ä»¶æ•°: {total_files}\n")
        f.write(f"æ€»ç›®å½•æ•°: {total_dirs}\n")
    
    print(f"å¢å¼ºç‰ˆæ–‡ä»¶æ¸…å•å·²ç”Ÿæˆåˆ°: {output_filename}")
```

å¢å¼ºç‰ˆçš„æ–°ç‰¹æ€§ï¼š
- **å±‚çº§ç¼©è¿›**ï¼šé€šè¿‡`indent_level`å‚æ•°æ§åˆ¶ç¼©è¿›æ·±åº¦ï¼Œæ¸…æ™°å±•ç¤ºç›®å½•ç»“æ„
- **æ–‡ä»¶ç»Ÿè®¡**ï¼šç»Ÿè®¡æ€»æ–‡ä»¶æ•°å’Œç›®å½•æ•°
- **æ–‡ä»¶å¤§å°**ï¼šæ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„å¤§å°ä¿¡æ¯
- **å›¾æ ‡æ ‡è¯†**ï¼šç”¨emojiåŒºåˆ†æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
- **æ—¶é—´æˆ³**ï¼šè®°å½•ç”Ÿæˆæ—¶é—´

## æ ¸å¿ƒæŠ€æœ¯è¦ç‚¹æ€»ç»“

é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å‡ ä¸ªé‡è¦çš„ç¼–ç¨‹æ¦‚å¿µï¼š

1. **é€’å½’æ€ç»´**ï¼šé€šè¿‡å‡½æ•°è°ƒç”¨è‡ªèº«è§£å†³é‡å¤æ€§é—®é¢˜
2. **è·¯å¾„å¤„ç†**ï¼šä½¿ç”¨`os.path.join()`å®‰å…¨æ‹¼æ¥è·¯å¾„
3. **æ–‡ä»¶åˆ¤æ–­**ï¼š`os.path.isdir()`å’Œ`os.path.isfile()`çš„åº”ç”¨
4. **å¼‚å¸¸å¤„ç†**ï¼šå¤„ç†æƒé™ä¸è¶³ç­‰å¼‚å¸¸æƒ…å†µ
5. **æ–‡ä»¶æ“ä½œ**ï¼šä½¿ç”¨`with`è¯­å¥å®‰å…¨æ“ä½œæ–‡ä»¶
6. **ä»£ç æ¼”è¿›**ï¼šä»ç®€å•æ‰“å°åˆ°æ–‡ä»¶å†™å…¥ï¼Œå†åˆ°åŠŸèƒ½å¢å¼º

## å®é™…åº”ç”¨åœºæ™¯

è¿™ç§æ–‡ä»¶æ¸…å•ç”Ÿæˆå·¥å…·åœ¨å®é™…å·¥ä½œä¸­å¾ˆæœ‰ç”¨ï¼š
- **é¡¹ç›®ç®¡ç†**ï¼šå¿«é€Ÿäº†è§£é¡¹ç›®æ–‡ä»¶ç»“æ„
- **æ–‡ä»¶æ•´ç†**ï¼šæ¸…ç†é‡å¤æˆ–æ— ç”¨æ–‡ä»¶å‰çš„ç°çŠ¶è®°å½•
- **å¤‡ä»½æ£€æŸ¥**ï¼šéªŒè¯å¤‡ä»½æ˜¯å¦å®Œæ•´
- **æ–‡æ¡£ç¼–å†™**ï¼šä¸ºé¡¹ç›®æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶ç´¢å¼•

## å°ç»“

ä»æœ€åˆçš„`os.listdir()`å±€é™æ€§ï¼Œåˆ°å¼•å…¥é€’å½’æ€ç»´ï¼Œå†åˆ°åŠŸèƒ½é€æ­¥å¢å¼ºï¼Œæˆ‘ä»¬ä¸ä»…è§£å†³äº†æ·±å±‚ç›®å½•éå†çš„é—®é¢˜ï¼Œè¿˜å­¦ä¼šäº†å¦‚ä½•é€šè¿‡è¿­ä»£æ”¹è¿›è®©ä»£ç æ›´å®ç”¨ã€æ›´å¥å£®ã€‚

é€’å½’è™½ç„¶æ¦‚å¿µæŠ½è±¡ï¼Œä½†æŒæ¡äº†"å¤§é—®é¢˜åˆ†è§£ä¸ºå°é—®é¢˜"çš„æ ¸å¿ƒæ€æƒ³åï¼Œå¾ˆå¤šå¤æ‚çš„æ–‡ä»¶æ“ä½œéƒ½èƒ½è¿åˆƒè€Œè§£ã€‚

ä¸‹æ¬¡é‡åˆ°éœ€è¦å¤„ç†å¤æ‚ç›®å½•ç»“æ„çš„ä»»åŠ¡æ—¶ï¼Œä¸å¦¨è€ƒè™‘ä¸€ä¸‹é€’å½’æ˜¯å¦èƒ½æ´¾ä¸Šç”¨åœºï¼
