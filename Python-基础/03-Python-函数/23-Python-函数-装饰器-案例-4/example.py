# -*- coding: utf-8 -*-

# @Time    : 2025-5-29
# @Author  : ç¨‹åºå‘˜NEO
# @FileName: example.py
# @Software: VSCode
# @Email   : it666@linux.do
# @Github  : https://github.com/BNTang
# @Description: 23-Python-å‡½æ•°-è£…é¥°å™¨-æ¡ˆä¾‹-4

"""
è£…é¥°å™¨æ¡ˆä¾‹æ¼”ç¤ºï¼š
1. å¼€æ”¾å°é—­åŸåˆ™ï¼šå·²å†™å¥½çš„ä»£ç å°½å¯èƒ½ä¸ä¿®æ”¹ï¼Œæ–°å¢åŠŸèƒ½é€šè¿‡æ‰©å±•å®ç°
2. å•ä¸€èŒè´£åŸåˆ™ï¼šä¸€ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹æƒ…
3. è£…é¥°å™¨æ¨¡å¼ï¼šåœ¨ä¸ä¿®æ”¹åŸå‡½æ•°çš„æƒ…å†µä¸‹ï¼Œä¸ºå‡½æ•°æ·»åŠ é¢å¤–åŠŸèƒ½
"""

print("=" * 50)
print("è£…é¥°å™¨æ¡ˆä¾‹æ¼”ç¤º")
print("=" * 50)

# ==================== ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€åŠŸèƒ½å‡½æ•° ====================
print("\nã€ç¬¬ä¸€é˜¶æ®µã€‘åŸºç¡€åŠŸèƒ½å‡½æ•°")

def post_status():
    """å‘è¯´è¯´åŠŸèƒ½"""
    print("å‘è¯´è¯´")

def post_image():
    """å‘å›¾ç‰‡åŠŸèƒ½"""
    print("å‘å›¾ç‰‡")

print("åŸå§‹åŠŸèƒ½æµ‹è¯•ï¼š")
post_status()
post_image()

# ==================== ç¬¬äºŒé˜¶æ®µï¼šç›´æ¥ä¿®æ”¹å‡½æ•°ä½“ï¼ˆé—®é¢˜ä»£ç ï¼‰ ====================
print("\nã€ç¬¬äºŒé˜¶æ®µã€‘ç›´æ¥ä¿®æ”¹å‡½æ•°ä½“ - è¿åå¼€æ”¾å°é—­åŸåˆ™å’Œå•ä¸€èŒè´£åŸåˆ™")

def post_status_v2():
    """å‘è¯´è¯´åŠŸèƒ½ - æ·»åŠ äº†ç™»å½•éªŒè¯ï¼ˆé—®é¢˜ï¼šè¿åå•ä¸€èŒè´£åŸåˆ™ï¼‰"""
    print("ç™»å½•éªŒè¯")  # é¢å¤–æ·»åŠ çš„åŠŸèƒ½
    print("å‘è¯´è¯´")    # åŸæœ‰åŠŸèƒ½

def post_image_v2():
    """å‘å›¾ç‰‡åŠŸèƒ½ - æ·»åŠ äº†ç™»å½•éªŒè¯ï¼ˆé—®é¢˜ï¼šè¿åå•ä¸€èŒè´£åŸåˆ™ï¼‰"""
    print("ç™»å½•éªŒè¯")  # é¢å¤–æ·»åŠ çš„åŠŸèƒ½
    print("å‘å›¾ç‰‡")    # åŸæœ‰åŠŸèƒ½

print("é—®é¢˜ä»£ç æ¼”ç¤ºï¼š")
print("é—®é¢˜1ï¼šè¿åå•ä¸€èŒè´£åŸåˆ™ - å‡½æ•°æ—¢è¦åšåŸæœ¬çš„äº‹ï¼Œåˆè¦åšéªŒè¯")
print("é—®é¢˜2ï¼šè¿åå¼€æ”¾å°é—­åŸåˆ™ - ä¿®æ”¹äº†å·²æœ‰çš„å‡½æ•°ä½“")
print("é—®é¢˜3ï¼šä»£ç é‡å¤ - æ¯ä¸ªå‡½æ•°éƒ½è¦æ·»åŠ ç›¸åŒçš„éªŒè¯ä»£ç ")
post_status_v2()
post_image_v2()

# ==================== ç¬¬ä¸‰é˜¶æ®µï¼šæå–éªŒè¯å‡½æ•°ï¼ˆä»æœ‰é—®é¢˜ï¼‰ ====================
print("\nã€ç¬¬ä¸‰é˜¶æ®µã€‘æå–éªŒè¯å‡½æ•° - ä»éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ")

def login_check(func):
    """ç™»å½•éªŒè¯å‡½æ•°"""
    print("ç™»å½•éªŒè¯")
    func()  # æ‰§è¡Œä¼ å…¥çš„å‡½æ•°

def login_check_status():
    """å‘è¯´è¯´å‰éªŒè¯"""
    login_check(post_status)

def login_check_image():
    """å‘å›¾ç‰‡å‰éªŒè¯"""
    login_check(post_image)

print("æ”¹è¿›1ï¼šæå–äº†å…¬å…±éªŒè¯é€»è¾‘")
print("é—®é¢˜ï¼šä¸šåŠ¡ä»£ç éœ€è¦ä¿®æ”¹è°ƒç”¨æ–¹å¼")
login_check_status()
login_check_image()

# ==================== ç¬¬å››é˜¶æ®µï¼šä½¿ç”¨é—­åŒ…å®ç°è£…é¥°å™¨ ====================
print("\nã€ç¬¬å››é˜¶æ®µã€‘ä½¿ç”¨é—­åŒ…å®ç°è£…é¥°å™¨æ¨¡å¼")

def decorator_login_check(func):
    """è£…é¥°å™¨ï¼šä¸ºå‡½æ•°æ·»åŠ ç™»å½•éªŒè¯åŠŸèƒ½
    
    Args:
        func: éœ€è¦è£…é¥°çš„å‡½æ•°
        
    Returns:
        wrapper: åŒ…è£…åçš„æ–°å‡½æ•°
    """
    def wrapper():
        """å†…éƒ¨åŒ…è£…å‡½æ•°"""
        print("ç™»å½•éªŒè¯")  # æ·»åŠ çš„æ–°åŠŸèƒ½
        func()            # æ‰§è¡ŒåŸå‡½æ•°
    return wrapper       # è¿”å›åŒ…è£…åçš„å‡½æ•°

# é‡æ–°æŒ‡å‘è£…é¥°åçš„å‡½æ•°
post_status = decorator_login_check(post_status)
post_image = decorator_login_check(post_image)

print("è£…é¥°å™¨æ¨¡å¼ä¼˜åŠ¿ï¼š")
print("1. ä¸ä¿®æ”¹åŸå‡½æ•°ä½“")
print("2. ä¸ä¿®æ”¹ä¸šåŠ¡è°ƒç”¨ä»£ç ")
print("3. é€šè¿‡é—­åŒ…åŠ¨æ€æ·»åŠ åŠŸèƒ½")

# æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘
s = 1
if s == 1:
    print("ä¸šåŠ¡ä»£ç è°ƒç”¨ - å‘è¯´è¯´ï¼š")
    post_status()
else:
    print("ä¸šåŠ¡ä»£ç è°ƒç”¨ - å‘å›¾ç‰‡ï¼š")
    post_image()

# ==================== ç¬¬äº”é˜¶æ®µï¼šPythonè¯­æ³•ç³– ====================
print("\nã€ç¬¬äº”é˜¶æ®µã€‘Pythonè£…é¥°å™¨è¯­æ³•ç³–")

def auth_decorator(func):
    """è®¤è¯è£…é¥°å™¨ - ä½¿ç”¨è¯­æ³•ç³–å½¢å¼"""
    def wrapper():
        print("ğŸ” æƒé™éªŒè¯")
        func()
    return wrapper

@auth_decorator
def share_moment():
    """åˆ†äº«åŠ¨æ€"""
    print("ğŸ“ åˆ†äº«åŠ¨æ€")

@auth_decorator  
def upload_photo():
    """ä¸Šä¼ ç…§ç‰‡"""
    print("ğŸ“· ä¸Šä¼ ç…§ç‰‡")

print("è¯­æ³•ç³–å½¢å¼è£…é¥°å™¨ï¼š")
print("@auth_decorator ç­‰ä»·äº share_moment = auth_decorator(share_moment)")

share_moment()
upload_photo()

# ==================== ç¬¬å…­é˜¶æ®µï¼šå¸¦å‚æ•°çš„è£…é¥°å™¨ ====================
print("\nã€ç¬¬å…­é˜¶æ®µã€‘å¸¦å‚æ•°çš„è£…é¥°å™¨")

def permission_required(permission):
    """éœ€è¦ç‰¹å®šæƒé™çš„è£…é¥°å™¨å·¥å‚
    
    Args:
        permission: éœ€è¦çš„æƒé™ç±»å‹
        
    Returns:
        decorator: å®é™…çš„è£…é¥°å™¨å‡½æ•°
    """
    def decorator(func):
        def wrapper():
            print(f"ğŸ”’ æ£€æŸ¥{permission}æƒé™")
            print(f"âœ… {permission}æƒé™éªŒè¯é€šè¿‡")
            func()
        return wrapper
    return decorator

@permission_required("ç®¡ç†å‘˜")
def delete_post():
    """åˆ é™¤å¸–å­"""
    print("ğŸ—‘ï¸ åˆ é™¤å¸–å­")

@permission_required("ç”¨æˆ·")
def like_post():
    """ç‚¹èµå¸–å­"""
    print("ğŸ‘ ç‚¹èµå¸–å­")

print("å¸¦å‚æ•°çš„è£…é¥°å™¨æ¼”ç¤ºï¼š")
delete_post()
like_post()

# ==================== ç¬¬ä¸ƒé˜¶æ®µï¼šè£…é¥°å™¨æœ€ä½³å®è·µ ====================
print("\nã€ç¬¬ä¸ƒé˜¶æ®µã€‘è£…é¥°å™¨æœ€ä½³å®è·µ")

import functools

def advanced_decorator(func):
    """é«˜çº§è£…é¥°å™¨ - ä¿ç•™åŸå‡½æ•°ä¿¡æ¯"""
    @functools.wraps(func)  # ä¿ç•™åŸå‡½æ•°çš„å…ƒæ•°æ®
    def wrapper(*args, **kwargs):
        """æ”¯æŒä»»æ„å‚æ•°çš„åŒ…è£…å™¨"""
        print(f"ğŸš€ æ‰§è¡Œå‰ç½®æ“ä½œ: {func.__name__}")
        result = func(*args, **kwargs)
        print(f"âœ¨ æ‰§è¡Œåç½®æ“ä½œ: {func.__name__}")
        return result
    return wrapper

@advanced_decorator
def send_message(message, user="åŒ¿å"):
    """å‘é€æ¶ˆæ¯
    
    Args:
        message: æ¶ˆæ¯å†…å®¹
        user: ç”¨æˆ·å
        
    Returns:
        bool: å‘é€æ˜¯å¦æˆåŠŸ
    """
    print(f"ğŸ“§ {user}å‘é€æ¶ˆæ¯: {message}")
    return True

print("é«˜çº§è£…é¥°å™¨ç‰¹æ€§ï¼š")
print("1. æ”¯æŒä»»æ„å‚æ•°")
print("2. ä¿ç•™åŸå‡½æ•°å…ƒæ•°æ®") 
print("3. æ”¯æŒè¿”å›å€¼")
print(f"å‡½æ•°å: {send_message.__name__}")
print(f"å‡½æ•°æ–‡æ¡£: {send_message.__doc__}")

result = send_message("Hello World!", user="Alice")
print(f"è¿”å›å€¼: {result}")

# ==================== æ€»ç»“ ====================
print("\n" + "=" * 50)
print("è£…é¥°å™¨æ ¸å¿ƒæ¦‚å¿µæ€»ç»“")
print("=" * 50)
print("""
ğŸ¯ è£…é¥°å™¨çš„æœ¬è´¨ï¼š
   - æ˜¯ä¸€ä¸ªæ¥å—å‡½æ•°ä½œä¸ºå‚æ•°å¹¶è¿”å›å‡½æ•°çš„å‡½æ•°
   - åˆ©ç”¨Pythonçš„é—­åŒ…ç‰¹æ€§å®ç°
   - åœ¨ä¸ä¿®æ”¹åŸå‡½æ•°çš„å‰æä¸‹æ‰©å±•åŠŸèƒ½

ğŸ“š è®¾è®¡åŸåˆ™ï¼š
   1. å¼€æ”¾å°é—­åŸåˆ™ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
   2. å•ä¸€èŒè´£åŸåˆ™ï¼šä¸€ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹

ğŸ”§ è£…é¥°å™¨ç±»å‹ï¼š
   1. ç®€å•è£…é¥°å™¨ï¼š@decorator
   2. å¸¦å‚æ•°è£…é¥°å™¨ï¼š@decorator(args)
   3. ç±»è£…é¥°å™¨ï¼šä½¿ç”¨ç±»å®ç°è£…é¥°å™¨
   4. å¤šå±‚è£…é¥°å™¨ï¼š@decorator1 @decorator2

ğŸ’¡ åº”ç”¨åœºæ™¯ï¼š
   - æƒé™éªŒè¯ã€æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§
   - ç¼“å­˜ã€é‡è¯•æœºåˆ¶ã€å‚æ•°æ ¡éªŒ
   - AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰

âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
   - ä½¿ç”¨functools.wrapsä¿ç•™åŸå‡½æ•°ä¿¡æ¯
   - è€ƒè™‘è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº
   - é¿å…è¿‡åº¦ä½¿ç”¨é€ æˆä»£ç éš¾ä»¥ç†è§£
""")
